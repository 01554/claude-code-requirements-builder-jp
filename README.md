# Claude 要件収集システム

自動探索により段階的にコンテキストを構築し、シンプルなはい/いいえの質問を行い、包括的な要件ドキュメントを生成する、Claude Code向けのインテリジェントな要件収集システムです。

## 🎯 概要

このシステムは要件収集プロセスを以下のように変革します：
- **コードベース認識型の質問**: AIが最初にコードを分析し、その後で情報に基づいた質問をします
- **シンプルなはい/いいえ形式**: すべての質問は賢いデフォルト設定付きのはい/いいえ形式 - わからない場合は「idk」と答えるだけでデフォルトを使用
- **2段階の質問**: コンテキスト把握のための5つの高レベル質問、その後コード分析後の5つのエキスパート質問
- **自動ドキュメント生成**: 特定のファイルパスとパターンを含む包括的な仕様を生成
- **プロダクトマネージャーフレンドリー**: 質問に答えるのにコードの知識は不要

## 🚀 クイックスタート

```bash
# 新機能の要件収集を開始
/requirements-start add user profile picture upload

# 進捗を確認して継続
/requirements-status

# 現在の要件の詳細を表示
/requirements-current

# すべての要件をリスト表示
/requirements-list

# 現在の要件収集を終了
/requirements-end

# AIが軌道から外れた場合のクイックリマインダー
/remind
```

## 📁 リポジトリ構造

```
claude-requirements/
├── commands/                     # Claude コマンド定義
│   ├── requirements-start.md    # 新規要件の開始
│   ├── requirements-status.md   # 進捗確認（エイリアス: current）
│   ├── requirements-current.md  # アクティブな要件を表示
│   ├── requirements-end.md      # 要件を最終化
│   ├── requirements-list.md     # すべての要件をリスト表示
│   └── requirements-remind.md   # AIにルールをリマインド
│
├── requirements/                 # 要件ドキュメントストレージ
│   ├── .current-requirement     # アクティブな要件を追跡
│   ├── index.md                 # すべての要件のサマリー
│   └── YYYY-MM-DD-HHMM-name/   # 個別の要件フォルダ
│       ├── metadata.json        # ステータスと進捗の追跡
│       ├── 00-initial-request.md    # ユーザーの元のリクエスト
│       ├── 01-discovery-questions.md # 5つのコンテキスト質問
│       ├── 02-discovery-answers.md   # ユーザーの回答
│       ├── 03-context-findings.md    # AIのコード分析
│       ├── 04-detail-questions.md    # 5つのエキスパート質問
│       ├── 05-detail-answers.md      # ユーザーの詳細な回答
│       └── 06-requirements-spec.md   # 最終要件
│
└── examples/                     # 要件の例
```

## 🔄 動作の仕組み

### フェーズ1: 初期セットアップとコードベース分析
```
User: /requirements-start add export functionality to reports
```
AIがコードベース全体の構造を分析し、アーキテクチャ、技術スタック、パターンを理解します。

### フェーズ2: コンテキスト発見の質問
AIが問題空間を理解するために5つのはい/いいえの質問をします：
```
Q1: ユーザーはこの機能を視覚的なインターフェースで操作しますか？
（不明な場合のデフォルト: はい - ほとんどの機能にはUIコンポーネントがあります）

ユーザー: はい

Q2: この機能はモバイルデバイスで動作する必要がありますか？
（不明な場合のデフォルト: はい - モバイルファーストが標準です）

ユーザー: idk
AI: ✓ デフォルトを使用: はい

[回答を記録する前に5つの質問すべてを続行]
```

### フェーズ3: ターゲットを絞ったコンテキスト収集（自律的）
AIが自律的に：
- 発見の回答に基づいて特定のファイルを検索
- 関連するコードセクションを読み取り
- 類似機能を詳細に分析
- 技術的制約とパターンを文書化

### フェーズ4: エキスパート要件の質問
深いコンテキストで、5つの詳細なはい/いいえの質問をします：
```
Q1: services/ExportService.tsの既存のExportServiceを使用すべきですか？
（不明な場合のデフォルト: はい - アーキテクチャの一貫性を維持）

ユーザー: はい

Q2: PDFエクスポートには標準テンプレート以外のカスタムフォーマットが必要ですか？
（不明な場合のデフォルト: いいえ - 標準テンプレートがほとんどのユースケースをカバー）

ユーザー: いいえ

[回答を記録する前に5つの質問すべてを続行]
```

### フェーズ5: 要件ドキュメント
以下を含む包括的な仕様を生成：
- 問題のステートメントとソリューションの概要
- 10個すべての回答からの機能要件
- 特定のファイルパスを含む技術要件
- 従うべき実装パターン
- 受け入れ基準

## 📋 コマンドリファレンス

### `/requirements-start [description]`
新機能や変更の要件収集を開始します。

**例:**
```
/requirements-start implement dark mode toggle
```

### `/requirements-status` または `/requirements-current`
現在の要件の進捗を表示し、収集を継続します。

**出力:**
```
📋 アクティブな要件: dark-mode-toggle
フェーズ: 発見の質問
進捗: 3/5 の質問に回答済み

次: Q4: これはデバイス間で同期すべきですか？
```

### `/requirements-end`
現在の要件を完了とします（不完全でも）。

**オプション:**
1. 現在の情報で仕様を生成
2. 後で続けるために未完了としてマーク
3. キャンセルして削除

### `/requirements-list`
すべての要件とそのステータスを表示します。

**出力:**
```
✅ 完了: dark-mode-toggle (実装準備完了)
🔴 アクティブ: user-notifications (発見 3/5)
⚠️ 未完了: data-export (3日前に一時停止)
```

### `/remind` または `/requirements-remind`
AIに要件収集のルールに従うよう再確認させます。

**AIが以下の時に使用:**
- オープンエンドの質問をする
- コードの実装を開始する
- 一度に複数の質問をする

## 🎯 機能

### スマートなデフォルト
すべての質問には以下に基づいたインテリジェントなデフォルトが含まれます：
- ベストプラクティス
- コードベースのパターン
- 発見されたコンテキスト

### 段階的な質問
- **フェーズ1**: 最初にコードベース構造を分析
- **フェーズ2**: プロダクトマネージャー向けの5つの高レベル質問
- **フェーズ3**: 関連コードへの自律的な深い探索
- **フェーズ4**: コード理解に基づいた5つのエキスパート質問

### 自動ファイル管理
- すべてのファイルを自動作成
- セッション間で進捗を追跡
- いつでも再開可能

### 統合準備完了
- 開発セッションへのリンク
- PRとコミットの参照
- 検索可能な要件履歴

## 💡 ベストプラクティス

### ユーザー向け
1. **具体的に**: 明確な初期説明がAIのより良い質問を助けます
2. **デフォルトを使用**: 「idk」は完全に問題ありません - デフォルトは十分に考慮されています
3. **集中を保つ**: AIが軌道から外れたら `/remind` を使用
4. **準備ができたら完了**: すべての質問に答える義務を感じる必要はありません

### 要件向け
1. **一度に1つの機能**: 要件を集中的に保つ
2. **実装を考える**: 別のAIがどのようにこれを使用するかを考慮
3. **決定を文書化**: 「なぜ」は「何を」と同じくらい重要
4. **すべてをリンク**: 要件をセッションとPRに接続

## 🔧 インストール

1. このリポジトリをクローン:
```bash
git clone https://github.com/rizethereum/claude-code-requirements-builder.git
```

2. コマンドをプロジェクトにコピー:
```bash
cp -r commands ~/.claude/commands/
# または プロジェクト固有の場合
cp -r commands /your/project/.claude/commands/
```

3. 要件ディレクトリを作成:
```bash
mkdir -p requirements
touch requirements/.current-requirement
```

4. 必要に応じて `.gitignore` に追加:
```
requirements/
```

## 📚 例

### 機能開発
```
/requirements-start add user avatar upload
# AIがコードベース構造を分析
# 機能について5つのはい/いいえの質問に回答
# AIが関連コードを自律的に調査
# 5つのエキスパートはい/いいえの質問に回答
# ファイルパスを含む包括的な要件ドキュメントを取得
```

### バグ修正の要件
```
/requirements-start fix dashboard performance issues
# スコープについての質問に回答
# AIが問題のあるコンポーネントを特定
# 受け入れ可能な解決策についての質問に回答
# ターゲットを絞った修正要件を取得
```

### UI強化
```
/requirements-start improve mobile navigation experience
# 現在の問題についての質問に回答
# AIが既存のナビゲーションを分析
# 望ましい動作についての質問に回答
# 詳細なUI要件を取得
```

## 🤝 貢献

1. リポジトリをフォーク
2. 機能ブランチを作成
3. 新しいコマンドを追加または既存のものを改善
4. プルリクエストを送信

### 貢献のアイデア
- 一般的な機能の要件テンプレートを追加
- 要件検証コマンドを作成
- 要件から実装への追跡を構築
- 多言語質問サポートを追加

## 📄 ライセンス

MIT ライセンス - プロジェクトで自由に使用・修正してください。

## 🙏 謝辞

[@iannuttall](https://github.com/iannuttall)の[claude-sessions](https://github.com/iannuttall/claude-sessions)プロジェクトにインスパイアされました。このプロジェクトはClaude Code向けの構造化されたセッション管理の概念を開拓しました。

---

**覚えておいてください**: 今日の良い要件は明日の混乱を防ぎます！
